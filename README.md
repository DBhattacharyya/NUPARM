# NUPARM
Analysis of Nucleic Acid Structural Features
NUPARM - A Nucleic Acid Parameter Determination Program

The NUPARM program has been developed so as to meet most of the requirements 
stipulated at the EMBO Workshop on DNA Curvature and Bending, held at 
Cambridge, U.K., in Sept. 1988. The Nomenclature and Description of the DNA 
structural parameters follows the Cambridge Convention (as published in J. Mol. 
Biol. (1989) 205, 787-791, J. Biomol. Struct. Dynam 6, 627-634(1989), EMBO J 8, 
1-4 (1989)).
In the web version of [NUPARM](http://nucleix.mbu.iisc.ernet.in/nuparm/nuparm.shtml) 
the various options available in the original version of NUPARM have been restricted 
to some standard ones. 

## INSTALLATION:
The program is organized in a single Fortran program file with two
header files.  It can be compiled by most of the available compilers, such as
g77, g95, ifort, gfortran, etc by simple compilation command.  While running
the program it requires four files (AdeVariants.name, etc) containing names of 
different nucleotide variants.  In the supplied code the program expects those
files in /usr/local/bin directory.  Please transfer the above files in
/usr/local/bin before running the program.  In case you do not have access to
/usr/local/bin you may keep the files in any other directory, such as
$HOME/bin, and modify the code (line no. 1067, 1076, 1084 and 1092) and
compile again.  Similarly the file "surface.xyz" can be moved to
/usr/local/bin or $HOME/bin and the line (no. 5180) needs to be modified
before compiling.

### INPUT TO THE PROGRAM:
The program runs in standard Unix like command line mode where the special
options can be supplied using -[option].  Running the program without any
argument gives a complete list of options, such as
```bash
./nuparm.exe
NUPARM can be used in two ways:
  1. For a single pdb file and
  2. For a trajectory file in PDB format as created by VMD (for example).
 In the first case:
    NUPARM [-options] pdb_file_name
 In the second case:
    NUPARM [-options] trj_file_name -trj -param NAME -output out_file_name
 where the [-options] are as used in case 1.
 Options: -notdouble [default=double] 
      -notpdb [default=pdb]
      -bpinf file_name_for_BasePairing_Information
      -lsfit [default=cross-product method]
      -c1c1 [default=C6-C8 line as Y-axis]
      -cg [default=C6-C8 midpoint as BP center]
      -single [default=Single Strand Parameter not required
      -orient "atom selection" [default=Not required]
      -pp [default=Not required]
      -torsion [default=Not required]
      -ww (to consider all base pairs as Watson-Crick  type) [default=No]
      -overlap (to calculate base pair stacking overlap between successive base pairs) [default=No]
```
where the parameter NAME can be any of the base pair parameters, such as
propeller, buckle, etc, any of the base pair doublet parameters, such as Tilt,
Roll, etc, any of the main chain torsion angle, such as Alpha, Beta, etc,
Sugar pucker phase (SUGAR), Interchain P...P distance (PP) and Zp. 

The input file name for the nucleic acid double helix structure to be analyzed 
has to be specified first.  The input file should be in PDB format for a 
single structure or a collection of structures generated by Molecular Dynamics 
Simulation.  In the second case, for analysis of parameters for a collection
of structures the user needs to specify that the input structure file is a 
trajectory file by indicating "-trj" option.

The program normally expects structure of a regular double helix according to 
the standard PDB (antiparallel double helix) 5'-->3' residue 
numbering scheme, with the first nucleotide base paired to the last base. If 
not, the file containing a user-defined, residue numbering scheme has to be 
specified (the file has base overhangs, bulges etc, such that it is only 
partially paired as in tRNA and many other structures). This option can also 
be used to analyze duplexes in protein-DNA complex structures, if the residue 
numbers are unique. The residue numbers of paired bases have to be given in 
(I5, 1x, I5) format for a duplex. This file can be generated by [BPFIND](http://www.saha.ac.in/biop/bioinformatics.html)
software.  The name of that 
file can be supplied by a "-bpinf file_name" option. 
The helix can be reoriented to give the base-pair parameters with respect to a 
global axis. The realignment is done in two steps: 

(i) the best line is fitted (by the method of least squares) to a set of representative points taken 
either from all the residues, or the doublet steps. The molecule is rotated 
such that this line becomes parallel to the global Z-axis. 

(ii) The same representative points are used to find the mean point through which the line 
passes, and the molecule is translated such that this point coincides with the 
origin and the best line with the Z-axis. 

There are several options available for choosing the representative points. The user may choose between 
(a) the local helix origins for each of the doublet steps 
(b) the base-pair centers or 
(c) any atom in the backbone. 

These options are to be supplied by "-orient Selection" option.
The user can also leave the molecule in the original orientation, but then 
NUPARM may not give proper values for global helical parameters as well as 
cylindrical polar coordinates for P and C1' subsequently.
The options to calculate P--P and C1'--C1' cylindrical polar coordinates, the 
intra and inter chain distances for these atoms, all backbone and sugar ring 
torsion angles, as well as inter base parameters in each strand are also 
available.
### Output files:
The usual main chain and sugar torsion angles along with the sugar-pucker modes 
can be calculated by giving "-torsion" option.  In the second case if one 
chooses any torsion as the required parameter by "-param alpha", for example, 
NUPARM would calculate all the alpha torsion angles for each snapshot and 
store them in the output file.

In case of single PDB formatted file, the NUPARM program creates an output files for each run using an input file named "XXXX.YYY": 

1. "XXXX.PRM" contains all the parameters calculated. 
2. A second file "XXXX.COOR" is created if the option of reorienting the 
molecule about the global helix axis is used. It contains the transformed 
coordinates, as well as related residue and atom information. It can also be 
used as input for NUPARM. 

Details of output .PRM file:

The base-pair parameters calculated are grouped into four sets: 

1) The local base-pair step parameters : Tilt, Roll, Twist, Shift, Slide, Rise
and Cup.
 
2) The local helical parameters (w.r.t. a helix axis for each doublet step): 
Inclination, Tip, Helical Twist, Displacements (dx and dy) and Helical Rise (dz). 
 
3) The global helical parameters (w.r.t. a single global helix axis for the 
whole Helix): Inclination, Tip, Helical Twist, Displacements (dx and dy) and 
Helical Rise (dz). 
 
4a) Intra base-pair parameters: Propeller Twist, Buckle, Opening angle 
(defined as the angle between the lines C1'--C8 and C1'--C6 projected on to 
the mean base-pair plane), as well as the angles between the two glycosidic 
bonds (N--C1') and the C1'--C1' vector. The C8--C6 and C1'--C1' distances are 
also listed. All these parameters are not calculated for a single strand 
molecule.
 
4b) Another set of intra base-pair parameters, buckle, opening angle, propeller 
twist, stagger, shear and stretch, are also calculated following a base 
centered local axis definition (as described in Mukherjee, Bansal and
Bhattacharyya (2006) J. Comp. Aided Mol. Des. 20, 629-45).
The direction cosines of the local helix axes and base-pair normals as well as  
the coordinates of local helix origins and base-pair centers are printed next. 
The angle between each local helix axis and all others, as also the angles 
between base-pair normals are then tabulated. 
Next the cylindrical polar coordinates of the phosphate and C1' atoms, assuming 
the global axis to be the Z-axis, are printed. The intra and interchain 
phosphate distances are also listed, for P and C1' atoms.  
Finally if option to calculate the torsion angles is used, then the main chain 
torsion angles, the glycosidic torsion angles and the furanose ring, endocyclic 
torsion angles are printed. The sugar pucker phase angle and amplitude of 
puckering (as described in Harvey and Prabhakaran, J. Amer. Chem. Soc. (1986),
108, pp.6128-6136) are listed along with the ring torsion angles. This 
calculation is the most time consuming part of the analysis program.
Brief description of method used:
Only the purine\pyrimidine ring atoms are included when calculating the base 
normals. We found only a nominal difference in the parameters when all he 
pendant atoms are included. The mean base-pair normal is taken to be the 
average of the two normals in the base-pair, in order to minimize the 
differences due to the size of the purine and pyrimidine rings. 
The 5'-->3' direction of strand 1 is used to define the positive Z-direction 
and the Y-axis is taken as pointing towards this strand. The X-axis then points 
towards the major groove, as suggested in the Cambridge Convention (Dickerson 
et al 1989, JMB). The base-pair center is defined as the midpoint of C6 and C8 
atoms of pyrimidines and purines respectively. The long axis (Y-axis) can be 
along the C6---C8 direction and passes through the base-pair center. 
The definition of the local helix and wedge parameters are in terms of the 
local helix axis and the mean Z-axis respectively for the doublet involved (as 
described by us in J. Biomol. Struct. Dynam.(1989), 6, pp.635-653). In this 
description the signs of tilt, tip and buckle were opposite to the Cambridge 
definition. Subsequently the algorithm has been modified so as to follow the 
Cambridge Convention, wherein all clockwise rotations are positive when viewed 
down the rotation axis.
